\section{Binary and Categorical Data}
Many applications for which novelty detection methods might be applied will 
    feature both real and categorical data.  \makenote{rewrite} The most apparent 
    shortcoming of the projected Gamma model developed in~\cite{trubey:pg} is
    its inability to handle binary or categorical data.  In order to ameliorate this
    shortcoming, and as an added bonus propose a new method for anomaly detection in
    categorical data, we propose the following.

Suppose $C$ is a vector of $M$ random categorical variables.  Then $\bm{C}_{m}$ 
    is a random categorical variable, with $K_{m} \geq 2$ categories. Regard $\bm{W}$ 
    as $\bm{C}$, recoded in one-hot encoding.  That is, $\bm{W}$ is a binary vector of 
    length $K = \sum_{m = 1}^M K_{m}$, $\sum_{k = 1}^K W_k = M$, and every $m$ subset 
    of $\bm{W}$ sums to 1.  This corresponds to multinomial encoding for $\bm{C}_m$,
    with size 1. We then consider a Dirichlet-multinomial density for $\bm{W}_m$,
    established as
  \begin{equation}
    \label{eqn:dirmultinom}
    \bm{w}_{im}\mid\bm{\theta} 
    \sim 
    \int_{\pi_{im}} 
    \text{Multinom}(\bm{w}_{im}\mid\pi_{im})
    \text{Dir}(\pi\mid\bm{\theta})\text{d}\pi_{im}.
  \end{equation}
  Recall that the Dirichlet distribution is a special case of the projected gamma,
  where the rate parameters are uniformly fixed $\beta_{\ell} = \beta$.  We 
  investigated the general $\mathcal{PG}_1$ to replace the Dirichlet in 
  Equation~\ref{eqn:dirmultinom}, but a closed-form solution to the integral was 
  not available.  That said, we observe in \cite{trubey:pg}, that as a kernel 
  function in a Dirichlet process mixture, there was no demonstrable performance 
  advantage to allowing the rate parameters to vary.
 
  For simplicity of notation, consider, a \emph{concatenated} Dirichlet-multinomial 
  ($\mathcal{CDM}$) as a product of Dirichlet-multinomial densities.  That is, 
  $\mathcal{CDM}(\bm{w}\mid\bm{\alpha}) = \prod_{m = 1}^M\mathcal{DM}(\bm{w}_m\mid\bm{\alpha}_m)$.
  Then we can establish a Bayesian non-parametric categorical data model as:
  \begin{equation}
    \label{eqn:catdatamodel}
    \begin{aligned}
      \bm{W}_i \mid \bm{\alpha}_i &\sim \mathcal{CDM}\left(\bm{W}_i\mid\bm{\alpha}_i\right)\\
      \bm{\alpha_i} &\sim G\\
      G &\sim \mathcal{DP}\left(\eta, G_0\right)\\
    \end{aligned}
    ~\hspace{1cm}
    \begin{aligned}
    G_0 &= \mathcal{LN}\left(\bm{\alpha}\mid\bm{\mu},\Sigma\right)\\
    \mu &\sim \mathcal{N}\left(\bm{0},\bm{1}\right)\\
    \Sigma &\sim \mathcal{IW}\left(\nu, \Psi\right).
    \end{aligned}
  \end{equation}
  Note that there should exist a strong negative covariance between categories 
  within a categorical variable.  To account for this within the prior, the 
  parameter $\psi$ is a blocked diagonal matrix, with each $m$ block 
  corresponding to the $m$th categorical variable.  For a diagonal value of 
  $\psi_0$, the off-diagonals within the $m$ block set to $-\psi_0 d_m^{-2}$ 
  where $d_m$ is the number of categories in the $m$th categorical variable.

\subsection{Anomaly Detection Methods for Categorical Data}
To establish an anomaly detection algorithm using the data model described in 
  Equation~\ref{eqn:catdatamodel}, we establish a similar logic as described in
  Section~\ref{sec:novelty}.  






% EOF